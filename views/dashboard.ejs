<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= user.username %>'s CodeQuest Dashboard</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <script src="/js/music.js" defer></script>
    <script src="/js/auth-utils.js" defer></script>
    <style>
        /* Music Toggle Button */
        .music-toggle-btn {
            position: fixed;
            top: 85px;
            left: 15px;
            width: 48px;
            height: 48px;
            padding: 0;
            margin: 0;
            border: none;
            cursor: pointer;
            z-index: 10000;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            font-size: 28px;
            line-height: 48px;
            text-align: center;
            color: #fff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }
        
        /* Dashboard specific styles - STYLED LIKE PROFILE */
        body {
            background: var(--bg-primary);
            background-image: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
        }
        
        .dashboard {
            margin-top: 1rem;
        }
        
        .dashboard-header {
            margin: 20px auto;
            padding: 20px;
            max-width: 1200px;
            background: rgba(20, 30, 50, 0.95);
            border: 3px solid #FFD700;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
            position: relative;
        }
        
        .welcome-section {
            margin-bottom: 30px;
            text-align: center;
        }
        
        /* CLEAN HEADER TEXT STYLES - MATCHING PROFILE */
        .dashboard-title {
            font-size: 2rem;
            margin: 0 0 20px 0;
            padding: 0;
            color: #FFFFFF;
            font-weight: 900;
            line-height: 1.1;
            font-family: 'Arial Black', Arial, sans-serif;
            letter-spacing: 1px;
            background: #FFFFFF;
            -webkit-background-clip: text;
            -webkit-text-fill-color: #FFFFFF;
            background-clip: text;
            text-shadow: 3px 3px 0px #000000, -1px -1px 0px #000000, 1px -1px 0px #000000, -1px 1px 0px #000000;
        }
        
        .username-highlight {
            color: #FFD700;
            font-weight: 900;
            margin: 0 8px;
            text-shadow: 3px 3px 0px #000000, -1px -1px 0px #000000, 1px -1px 0px #000000, -1px 1px 0px #000000;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: #FFD700;
        }
        
        .dashboard-subtitle {
            font-size: 1.8rem;
            color: #FFFFFF;
            margin: 20px 0 0 0;
            padding: 0;
            font-weight: 600;
            text-shadow: 2px 2px 0px #000000, -1px -1px 0px #000000, 1px -1px 0px #000000, -1px 1px 0px #000000;
            text-align: center;
        }
        
        /* Quick Stats - CLEANED UP */
        .quick-stats {
            display: flex;
            gap: 20px;
            margin-top: 30px;
            justify-content: center;
        }
        
        .stat-item {
            background: var(--bg-card);
            border: 2px solid var(--silver);
            border-radius: 10px;
            padding: var(--spacing-lg);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            transition: all 0.3s ease;
            position: relative;
            z-index: 2;
        }
        
        .stat-item:hover {
            border-color: var(--gold);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        }
        
        .stat-icon {
            font-size: 2rem;
            color: var(--gold);
        }
        
        .stat-content {
            display: flex;
            flex-direction: column;
        }
        
        .stat-number {
            font-size: 1.8rem;
            font-weight: bold;
            color: white;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: white;
        }
        
        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Card Titles */
        .card-title i {
            color: #FFD700;
            text-shadow: 0 0 8px rgba(255, 215, 0, 0.5);
        }
        
        /* Responsive Design - MATCHING PROFILE */
        @media (max-width: 768px) {
            .dashboard-title {
                font-size: 2.2rem;
                text-align: center;
                margin-bottom: var(--spacing-lg);
            }
            
            .username-highlight {
                display: inline;
                font-size: 2.2rem;
            }
            
            .dashboard-subtitle {
                text-align: center;
                font-size: 1.2rem;
            }
            
            .quick-stats {
                flex-direction: column;
                gap: var(--spacing-md);
            }
            
            .stat-item {
                justify-content: center;
                text-align: center;
            }
        }
        
        /* Additional dashboard-specific styling to match existing look */
        .quest-progress {
            margin-bottom: 1.5rem;
        }
        
        .quest-info h3 {
            color: var(--gold);
            margin-bottom: 0.5rem;
        }
        
        .quest-progress-bar {
            background: var(--bg-tertiary);
            height: 12px;
            border-radius: 6px;
            overflow: hidden;
            margin: 1rem 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--gold), var(--silver));
            transition: width 0.3s ease;
        }
        
        .quest-stats {
            display: flex;
            justify-content: space-between;
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }
        
        .quest-actions {
            display: flex;
            gap: 1rem;
        }
        
        .skill-overview {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .skill-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--bg-hover);
            border-radius: 8px;
            border: 1px solid rgba(212, 175, 55, 0.1);
        }
        
        .skill-item.locked {
            opacity: 0.5;
        }
        
        .skill-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }
        
        .skill-icon.javascript {
            background: #F7DF1E;
            color: #000;
        }
        
        .skill-icon.python {
            background: #3776AB;
        }
        
        .skill-icon.react {
            background: #61DAFB;
            color: #000;
        }
        
        .skill-info {
            flex: 1;
        }
        
        .skill-name {
            font-weight: 600;
            color: white;
            margin-bottom: 0.25rem;
        }
        
        .skill-level {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .achievements-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .achievement-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--bg-hover);
            border-radius: 8px;
            border: 1px solid rgba(212, 175, 55, 0.1);
        }
        
        .achievement-icon {
            width: 40px;
            height: 40px;
            background: var(--gold);
            color: var(--bg-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .achievement-info {
            flex: 1;
        }
        
        .achievement-name {
            font-weight: 600;
            color: white;
            margin-bottom: 0.25rem;
        }
        
        .achievement-date {
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        
        .no-achievements {
            text-align: center;
            padding: 2rem 1rem;
            color: var(--text-muted);
        }
        
        .no-achievements i {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--gold);
            opacity: 0.5;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
        }
        
        .stat-box {
            background: var(--bg-hover);
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
            border: 1px solid rgba(212, 175, 55, 0.1);
        }
        
        .stat-box .stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--gold);
            margin-bottom: 0.25rem;
        }
        
        .stat-box .stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        .btn-full {
            display: block;
            width: 100%;
            text-align: center;
            margin-top: 1rem;
        }
        
        .action-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }
        
        .action-card {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.5rem;
            background: var(--bg-card);
            border: 2px solid var(--silver);
            border-radius: 10px;
            text-decoration: none;
            color: white;
            transition: all 0.3s ease;
        }
        
        .action-card:hover {
            border-color: var(--gold);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            text-decoration: none;
            color: white;
        }
        
        .action-icon {
            width: 50px;
            height: 50px;
            background: var(--gold);
            color: var(--bg-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            flex-shrink: 0;
        }
        
        .action-content h3 {
            margin: 0 0 0.5rem 0;
            color: white;
            font-size: 1.1rem;
        }
        
        .action-content p {
            margin: 0;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        /* Logout button styles */
        .logout-btn {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            text-decoration: none;
            padding: 8px 12px;
            border: 2px solid var(--crimson);
            border-radius: 8px;
            background: var(--bg-card);
            color: var(--text-primary);
            font-weight: 600;
            transition: all var(--transition-normal);
            white-space: nowrap;
        }
        
        .logout-btn:hover {
            background: var(--crimson);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 0 10px rgba(220, 20, 60, 0.3);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <a href="/" class="brand-link">
                    <img src="/images/logo.gif" alt="CodeQuest Logo" class="brand-logo">
                    <span class="brand-text">CodeQuest</span>
                </a>
            </div>
            
            <div class="nav-menu" id="navMenu">
                <a href="/" class="nav-link">Home</a>
                <a href="/leaderboard" class="nav-link">Leaderboard</a>
                <a href="/dashboard" class="nav-link">Dashboard</a>
                <a href="/profile" class="nav-link">Profile</a>
                <% if (user.role === 'admin') { %>
                <a href="/admin/analytics" class="nav-link" style="color: #FFD700; font-weight: bold;">
                    <i class="fas fa-chart-bar"></i> Admin
                </a>
                <% } %>
                <span class="nav-username">Welcome, <%= user.username %>!</span>
                <a href="/auth/logout" class="logout-btn" onclick="if(window.AuthUtils) window.AuthUtils.clearOnLogout(); return true;">
                    <i class="fas fa-sign-out-alt"></i>
                    Logout
                </a>
            </div>
            
            <div class="nav-toggle" id="navToggle">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Music Button -->
    <button id="toggleMusic" title="Music On" aria-pressed="true" class="music-toggle-btn">🔊</button>
    <section class="dashboard">
        <div class="container">
            <div class="dashboard-header">
                <div class="welcome-section">
                    <h1 class="dashboard-title">
                        Welcome back, <span class="username-highlight"><%= user.username %></span>!
                    </h1>
                    <p class="dashboard-subtitle">Ready to continue your coding adventure?</p>
                </div>
                <div class="quick-stats">
                    <div class="stat-item">
                        <div class="stat-icon">
                            <i class="fas fa-level-up-alt"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number"><%= user.level || 1 %></div>
                            <div class="stat-label">Level</div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number"><%= user.experience || 0 %></div>
                            <div class="stat-label">XP</div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon">
                            <i class="fas fa-medal"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number"><%= (user.badges && user.badges.length) || 0 %></div>
                            <div class="stat-label">Badges</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="dashboard-grid">
                <div class="dashboard-card main-card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-play-circle"></i>
                            Continue Your Journey
                        </h2>
                    </div>
                    <div class="card-content">
                        <div class="quest-progress">
                            <% if (typeof currentQuest !== 'undefined' && currentQuest) { %>
                                <div class="quest-info">
                                    <h3><%= currentQuest.title %></h3>
                                    <p><%= currentQuest.description %></p>
                                </div>
                                <div class="quest-progress-bar">
                                    <% 
                                    let progressPercent = 0;
                                    if (currentQuest.status === 'active') {
                                        progressPercent = 50;
                                    } else if (currentQuest.status === 'ready') {
                                        progressPercent = 100;
                                    }
                                    %>
                                    <div class="progress-fill" style="width: <%= progressPercent %>%"></div>
                                </div>
                                <div class="quest-stats">
                                    <% if (currentQuest.status === 'active') { %>
                                        <span>In Progress</span>
                                        <span><%= currentQuest.count %> Active Quest<%= currentQuest.count > 1 ? 's' : '' %></span>
                                    <% } else if (currentQuest.status === 'ready') { %>
                                        <span>Ready for More</span>
                                        <span><%= questProgress.completed %> Completed</span>
                                    <% } else { %>
                                        <span>Ready to Start</span>
                                        <span>Begin Your Journey</span>
                                    <% } %>
                                </div>
                            <% } else { %>
                                <div class="quest-info">
                                    <h3>Start Your Adventure!</h3>
                                    <p>Begin your coding journey in the game.</p>
                                </div>
                                <div class="quest-progress-bar">
                                    <div class="progress-fill" style="width: 0%"></div>
                                </div>
                                <div class="quest-stats">
                                    <span>Ready to Start</span>
                                    <span>0 Completed</span>
                                </div>
                            <% } %>
                        </div>
                        <div class="quest-actions">
                            <a href="/game" class="btn btn-primary">
                                <i class="fas fa-play"></i>
                                Continue Quest
                            </a>
                            <button class="btn btn-outline">
                                <i class="fas fa-list"></i>
                                View All Quests
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-trophy"></i>
                            Recent Achievements
                        </h2>
                    </div>
                    <div class="card-content">
                        <% if (user.badges && user.badges.length > 0) { %>
                            <div class="achievements-list">
                                <% user.badges.forEach(badge => { %>
                                    <div class="achievement-item">
                                        <div class="achievement-icon">
                                            <i class="fas fa-medal"></i>
                                        </div>
                                        <div class="achievement-info">
                                            <div class="achievement-name"><%= badge.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase()) %></div>
                                            <div class="achievement-date">Earned recently</div>
                                        </div>
                                    </div>
                                <% }); %>
                            </div>
                        <% } else { %>
                            <div class="no-achievements">
                                <i class="fas fa-medal"></i>
                                <p>No achievements yet. Complete challenges to earn your first badge!</p>
                            </div>
                        <% } %>
                        <a href="#achievements-section" class="btn btn-outline btn-full">
                            <i class="fas fa-trophy"></i>
                            View All Achievements
                        </a>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-chart-line"></i>
                            Progress Stats
                        </h2>
                    </div>
                    <div class="card-content">
                        <div class="stats-grid">
                            <div class="stat-box">
                                <div class="stat-number"><%= user.level || 1 %></div>
                                <div class="stat-label">Game Level</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-number"><%= user.pixelCoins || 0 %></div>
                                <div class="stat-label">Coins Earned</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-number"><%= user.extendedGameState?.completedQuests?.length || 0 %></div>
                                <div class="stat-label">Quests Completed</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-number"><%= user.extendedGameState?.activeQuests?.length || 0 %></div>
                                <div class="stat-label">Active Quests</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Quests Section -->
            <div id="quests-section" class="dashboard-card" style="margin-top: 2rem;">
                <div class="card-header">
                    <h2 class="card-title">
                        <i class="fas fa-scroll"></i>
                        All Quests
                    </h2>
                </div>
                <div class="card-content">
                    <% if (user.extendedGameState && user.extendedGameState.completedQuests && user.extendedGameState.completedQuests.length > 0) { %>
                        <div class="achievements-list">
                            <% user.extendedGameState.completedQuests.forEach((questId, index) => { %>
                                <div class="achievement-item">
                                    <div class="achievement-icon" style="background: #27ae60;">
                                        <i class="fas fa-check"></i>
                                    </div>
                                    <div class="achievement-info">
                                        <div class="achievement-name"><%= (typeof questData !== 'undefined' && questData[questId] && questData[questId].name) || ('Quest #' + questId) %></div>
                                        <div class="achievement-date"><%= (typeof questData !== 'undefined' && questData[questId] && questData[questId].description) || 'Status: Completed ✓' %></div>
                                    </div>
                                </div>
                            <% }); %>
                        </div>
                    <% } else { %>
                        <div class="no-achievements">
                            <i class="fas fa-scroll"></i>
                            <p>No quests completed yet. Start your adventure in the game!</p>
                        </div>
                    <% } %>
                    
                    <% if (user.extendedGameState && user.extendedGameState.activeQuests && user.extendedGameState.activeQuests.length > 0) { %>
                        <h3 style="color: #FFD700; margin-top: 2rem; margin-bottom: 1rem;">Active Quests</h3>
                        <div class="achievements-list">
                            <% user.extendedGameState.activeQuests.forEach((questId) => { %>
                                <div class="achievement-item">
                                    <div class="achievement-icon" style="background: #3498db;">
                                        <i class="fas fa-hourglass-half"></i>
                                    </div>
                                    <div class="achievement-info">
                                        <div class="achievement-name"><%= (typeof questData !== 'undefined' && questData[questId] && questData[questId].name) || ('Quest #' + questId) %></div>
                                        <div class="achievement-date"><%= (typeof questData !== 'undefined' && questData[questId] && questData[questId].description) || 'Status: In Progress' %></div>
                                    </div>
                                </div>
                            <% }); %>
                        </div>
                    <% } %>
                </div>
            </div>
            
            <!-- Achievements Section -->
            <div id="achievements-section" class="dashboard-card" style="margin-top: 2rem;">
                <div class="card-header">
                    <h2 class="card-title">
                        <i class="fas fa-trophy"></i>
                        All Achievements & Badges
                    </h2>
                </div>
                <div class="card-content">
                    <% if (user.badges && user.badges.length > 0) { %>
                        <div class="achievements-list">
                            <% user.badges.forEach((badge, index) => { %>
                                <div class="achievement-item">
                                    <div class="achievement-icon">
                                        <i class="fas fa-medal"></i>
                                    </div>
                                    <div class="achievement-info">
                                        <div class="achievement-name"><%= badge.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase()) %></div>
                                        <div class="achievement-date">Badge #<%= index + 1 %> - Earned</div>
                                    </div>
                                </div>
                            <% }); %>
                        </div>
                    <% } else { %>
                        <div class="no-achievements">
                            <i class="fas fa-medal"></i>
                            <p>No badges earned yet. Complete quests and challenges to earn badges!</p>
                        </div>
                    <% } %>
                    
                    <% if (user.achievements && user.achievements.length > 0) { %>
                        <h3 style="color: #FFD700; margin-top: 2rem; margin-bottom: 1rem;">Special Achievements</h3>
                        <div class="achievements-list">
                            <% user.achievements.forEach((achievement) => { %>
                                <div class="achievement-item">
                                    <div class="achievement-icon" style="background: #9b59b6;">
                                        <i class="fas fa-star"></i>
                                    </div>
                                    <div class="achievement-info">
                                        <div class="achievement-name"><%= achievement.name || achievement %></div>
                                        <div class="achievement-date"><%= achievement.description || 'Special Achievement' %></div>
                                    </div>
                                </div>
                            <% }); %>
                        </div>
                    <% } %>
                </div>
            </div>
            
            <div class="dashboard-actions">
                <div class="action-grid">
                    <a href="/leaderboard" class="action-card">
                        <div class="action-icon">
                            <i class="fas fa-crown"></i>
                        </div>
                        <div class="action-content">
                            <h3>Leaderboard</h3>
                            <p>See how you rank against other coders</p>
                        </div>
                    </a>
                    
                    <a href="#" class="action-card">
                        <div class="action-icon">
                            <i class="fas fa-code"></i>
                        </div>
                        <div class="action-content">
                            <h3>Code Challenges</h3>
                            <p>Battle through coding puzzles</p>
                        </div>
                    </a>
                    
                    <a href="#" class="action-card">
                        <div class="action-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="action-content">
                            <h3>Community</h3>
                            <p>Connect with fellow developers</p>
                        </div>
                    </a>
                    
                    <a href="/profile" class="action-card">
                        <div class="action-icon">
                            <i class="fas fa-user-cog"></i>
                        </div>
                        <div class="action-content">
                            <h3>Profile Settings</h3>
                            <p>Customize your coding journey</p>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Background Music -->
    <audio id="backgroundMusic" loop>
        <source src="/audio/music.mp3" type="audio/mpeg">
        <source src="/audio/music.ogg" type="audio/ogg">
    </audio>

    <script src="/js/main.js"></script>
    <script>
        // Load game data from database (user object) instead of localStorage
        document.addEventListener('DOMContentLoaded', function() {
            try {
                // FORCE clear all game localStorage data to prevent cross-account contamination
                const gameKeys = ['gameee_dashboard_data', 'gameee_player_data', 'gameee_game_state', 'gameState', 'playerData'];
                gameKeys.forEach(key => {
                    try {
                        localStorage.removeItem(key);
                        console.log('Cleared localStorage key:', key);
                    } catch (e) {
                        console.warn(`Failed to clear ${key}:`, e);
                    }
                });
                
                // Also use AuthUtils if available
                if (window.AuthUtils) {
                    window.AuthUtils.clearGameData();
                }
                
                // Use server-side user data instead of localStorage
                const userData = <%- JSON.stringify(user) %>;
                
                // Stats are now server-rendered, no need to update via JavaScript
                
                // Update subtitle with actual user progress
                const subtitle = document.querySelector('.dashboard-subtitle');
                if (subtitle && userData.level > 1) {
                    subtitle.textContent = `Level ${userData.level} adventurer with ${userData.pixelCoins || 0} coins earned!`;
                }
                
                // Update quest progress based on user level
                const progressFill = document.querySelector('.progress-fill');
                if (progressFill) {
                    const progressPercent = Math.min((userData.level * 15), 100); // 15% per level, max 100%
                    progressFill.style.width = progressPercent + '%';
                    
                    const questStats = document.querySelector('.quest-stats');
                    if (questStats) {
                        questStats.innerHTML = `
                            <span>${progressPercent}% Complete</span>
                            <span>Level ${userData.level} Achieved</span>
                        `;
                    }
                }
                
                console.log('✅ Dashboard loaded with user data from database:', {
                    level: userData.level,
                    coins: userData.pixelCoins,
                    quests: userData.gameStats?.questsCompleted,
                    username: userData.username
                });
                
            } catch (error) {
                console.error('❌ Failed to load user data:', error);
            }
        });
    </script>
</body>
</html>